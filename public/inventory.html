<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"">
    <title>Frame Inventory</title>
    <!--<script src=".js"></script>-->
    <link rel="stylesheet" type="text/css" href="stylesheets/inventory.css">
    <link rel="shortcut icon" href="https://www.flaticon.com/premium-icon/icons/svg/3137/3137168.svg" type="image/x-icon" >
    <!-- <link rel="shortcut icon" href="#"> -->
  </head>

<body onload="load()">

<h1>Inventory</h1>
<form method="GET" action="/updateInventory">
  <table id="displayTable">
    <tr><th colspan="10">Medium</th></tr>
    <tr><td class="col1 pop" onclick="pop('Un')" colspan="7">unplaned boards
      <span class="popuptext" id="popUn">
        <table>
          <tr><th colspan="2">last updated</th></tr>
          <tr><td>unplaned</td><td id="updateUn" class="update">date</td></tr>
      </table></span></td>
      <td><button onclick="minus(un); return false;">-</button></td>
      <td><input type="number" id="un" name="un" min="-1" max="500" value="-2"><br></td>
      <td><button onclick="plus(un); return false;">+</button></td>
    </tr>
    <tr><th></th><th colspan="3">Natural</th><th colspan="3">Gray</th><th colspan="3">Kona</th></tr>
    <tr><td class="col1 pop" onclick="pop('Stain')">planed/<br>stained
      <span class="popuptext" id="popStain">
        <table>
          <tr><th colspan="2">planed/stained last updated</th></tr>
          <tr><td>Natural</td><td id="updatestainN" class="update">date</td></tr>
          <tr><td>Gray</td>   <td id="updatestainG" class="update">date</td></tr>
          <tr><td>Kona</td>   <td id="updatestainK" class="update">date</td></tr>
        </table>
      </span></td>
      <td><button onclick="minus(stainN); return false;">-</button></td>
      <td class="below"><input type="number" id="stainN" name="stainN" min="-1" max="500" value="-2"><br>boards</td>
      <td><button onclick="plus(stainN); return false;">+</button></td>
      <td><button onclick="minus(stainG); return false;">-</button></td>
      <td class="below"><input type="number" id="stainG" name="stainG" min="-1" max="500" value="-2"><br>boards</td>
      <td><button onclick="plus(stainG); return false;">+</button></td>
      <td><button onclick="minus(stainK); return false;">-</button></td>
      <td class="below"><input type="number" id="stainK" name="stainK" min="-1" max="500" value="-2"><br>boards</td>
      <td><button onclick="plus(stainK); return false;">+</button></td>
    </tr>
    <tr><td class="col1 pop" onclick="pop('C')">cut
      <span class="popuptext" id="popC">
        <table>
          <tr><th colspan="2">cut last updated</th></tr>
          <tr><td>Natural</td><td id="updatecN" class="update">date</td></tr>
          <tr><td>Gray</td>   <td id="updatecG" class="update">date</td></tr>
          <tr><td>Kona</td>   <td id="updatecK" class="update">date</td></tr>
        </table>
      </span></td>
      <td><button onclick="minus(cN); return false;">-</button></td>
      <td class="below"><input type="number" id="cN" name="cN" min="-1" max="500" value="-2"><br>pieces</td>
      <td><button onclick="plus(cN); return false;">+</button></td>
      <td><button onclick="minus(cG); return false;">-</button></td>
      <td class="below"><input type="number" id="cG" name="cG" min="-1" max="500" value="-2"><br>pieces</td>
      <td><button onclick="plus(cG); return false;">+</button></td>
      <td><button onclick="minus(cK); return false;">-</button></td>
      <td class="below"><input type="number" id="cK" name="cK" min="-1" max="500" value="-2"><br>pieces</td>
      <td><button onclick="plus(cK); return false;">+</button></td>
    </tr>
    <tr><td class="col1 pop" onclick="pop('Sl')">slotted
      <span class="popuptext" id="popSl">
        <table>
          <tr><th colspan="2">slotted last updated</th></tr>
          <tr><td>Natural</td><td id="updateslN" class="update">date</td></tr>
          <tr><td>Gray</td>   <td id="updateslG" class="update">date</td></tr>
          <tr><td>Kona</td>   <td id="updateslK" class="update">date</td></tr>
        </table>
      </span></td>
      <td><button onclick="minus(slN); return false;">-</button></td>
      <td class="below"><input type="number" id="slN" name="slN" min="-1" max="500" value="-2"><br>pieces</td>
      <td><button onclick="plus(slN); return false;">+</button></td>
      <td><button onclick="minus(slG); return false;">-</button></td>
      <td class="below"><input type="number" id="slG" name="slG" min="-1" max="500" value="-2"><br>pieces</td>
      <td><button onclick="plus(slG); return false;">+</button></td>
      <td><button onclick="minus(slK); return false;">-</button></td>
      <td class="below"><input type="number" id="slK" name="slK" min="-1" max="500" value="-2"><br>pieces</td>
      <td><button onclick="plus(slK); return false;">+</button></td>
    </tr>
    <tr><td class="col1 pop" onclick="pop('Stapled')">stapled
      <span class="popuptext" id="popStapled">
        <table>
          <tr><th colspan="2">stapled last updated</th></tr>
          <tr><td>Natural</td><td id="updatestapledN" class="update">date</td></tr>
          <tr><td>Gray</td>   <td id="updatestapledG" class="update">date</td></tr>
          <tr><td>Kona</td>   <td id="updatestapledK" class="update">date</td></tr>
        </table>
      </span></td>
      <td><button onclick="minus(stapledN); return false;">-</button></td>
      <td class="below"><input type="number" id="stapledN" name="stapledN" min="-1" max="500" value="-2"><br>frames</td>
      <td><button onclick="plus(stapledN); return false;">+</button></td>
      <td><button onclick="minus(stapledG); return false;">-</button></td>
      <td class="below"><input type="number" id="stapledG" name="stapledG" min="-1" max="500" value="-2"><br>frames</td>
      <td><button onclick="plus(stapledG); return false;">+</button></td>
      <td><button onclick="minus(stapledK); return false;">-</button></td>
      <td class="below"><input type="number" id="stapledK" name="stapledK" min="-1" max="500" value="-2"><br>frames</td>
      <td><button onclick="plus(stapledK); return false;">+</button></td>
    </tr>
    <tr><td class="col1 pop" onclick="pop('D')">completed
      <span class="popuptext" id="popD">
        <table>
          <tr><th colspan="2">completed last updated</th></tr>
          <tr><td>Natural</td><td id="updatedN" class="update">date</td></tr>
          <tr><td>Gray</td>   <td id="updatedG" class="update">date</td></tr>
          <tr><td>Kona</td>   <td id="updatedK" class="update">date</td></tr>
        </table>
      </span></td>
      <td><button onclick="minus(dN); return false;">-</button></td>
      <td class="below"><input type="number" id="dN" name="dN" min="-1" max="500" value="-2"><br>frames</td>
      <td><button onclick="plus(dN); return false;">+</button></td>
      <td><button onclick="minus(dG); return false;">-</button></td>
      <td class="below"><input type="number" id="dG" name="dG" min="-1" max="500" value="-2"><br>frames</td>
      <td><button onclick="plus(dG); return false;">+</button></td>
      <td><button onclick="minus(dK); return false;">-</button></td>
      <td class="below"><input type="number" id="dK" name="dK" min="-1" max="500" value="-2"><br>frames</td>
      <td><button onclick="plus(dK); return false;">+</button></td>
    </tr>
    <tr><th colspan="10">Mini</th></tr>
    <tr><td class="col1 pop" onclick="pop('miniUn')" colspan="7">unplaned boards
      <span class="popuptext" id="popminiUn">
        <table>
          <tr><th colspan="2">last updated</th></tr>
          <tr><td>unplaned</td><td id="updateminiUn" class="update">date</td></tr>
        </table>
      </span></td>
      <td><button onclick="minus(miniun); return false;">-</button></td>
      <td><input type="number" id="miniun" name="miniun" min="-1" max="500" value="-2"><br></td>
      <td><button onclick="plus(miniun); return false;">+</button></td>
    </tr>
    <tr><th></th><th colspan="3">Natural</th><th colspan="3">Gray</th><th colspan="3">Kona</th></tr>
    <tr><td class="col1 pop" onclick="pop('miniStain')">planed/<br>stained
      <span class="popuptext" id="popminiStain">
        <table>
          <tr><th colspan="2">planed/stained last updated</th></tr>
          <tr><td>Natural</td><td id="updateministainN" class="update">date</td></tr>
          <tr><td>Gray</td>   <td id="updateministainG" class="update">date</td></tr>
          <tr><td>Kona</td>   <td id="updateministainK" class="update">date</td></tr>
        </table>
      </span></td>
      <td><button onclick="minus(ministainN); return false;">-</button></td>
      <td class="below"><input type="number" id="ministainN" name="ministainN" min="-2" max="500" value="-2"><br>boards</td>
      <td><button onclick="plus(ministainN); return false;">+</button></td>
      <td><button onclick="minus(ministainG); return false;">-</button></td>
      <td class="below"><input type="number" id="ministainG" name="ministainG" min="-1" max="500" value="-2"><br>boards</td>
      <td><button onclick="plus(ministainG); return false;">+</button></td>
      <td><button onclick="minus(ministainK); return false;">-</button></td>
      <td class="below"><input type="number" id="ministainK" name="ministainK" min="-1" max="500" value="-2"><br>boards</td>
      <td><button onclick="plus(ministainK); return false;">+</button></td>
    </tr>
    <tr><td class="col1 pop" onclick="pop('miniC')">cut
      <span class="popuptext" id="popminiC">
        <table>
          <tr><th colspan="2">cut last updated</th></tr>
          <tr><td>Natural</td><td id="updateminicN" class="update">date</td></tr>
          <tr><td>Gray</td>   <td id="updateminicG" class="update">date</td></tr>
          <tr><td>Kona</td>   <td id="updateminicK" class="update">date</td></tr>
        </table>
      </span></td>
      <td><button onclick="minus(minicN); return false;">-</button></td>
      <td class="below"><input type="number" id="minicN" name="minicN" min="-1" max="500" value="-2"><br>pieces</td>
      <td><button onclick="plus(minicN); return false;">+</button></td>
      <td><button onclick="minus(minicG); return false;">-</button></td>
      <td class="below"><input type="number" id="minicG" name="minicG" min="-1" max="500" value="-2"><br>pieces</td>
      <td><button onclick="plus(minicG); return false;">+</button></td>
      <td><button onclick="minus(minicK); return false;">-</button></td>
      <td class="below"><input type="number" id="minicK" name="minicK" min="-1" max="500" value="-2"><br>pieces</td>
      <td><button onclick="plus(minicK); return false;">+</button></td>
    </tr>
    <tr><td class="col1 pop" onclick="pop('miniSl')">slotted
      <span class="popuptext" id="popminiSl">
        <table>
          <tr><th colspan="2">slotted last updated</th></tr>
          <tr><td>Natural</td><td id="updateminislN" class="update">date</td></tr>
          <tr><td>Gray</td>   <td id="updateminislG" class="update">date</td></tr>
          <tr><td>Kona</td>   <td id="updateminislK" class="update">date</td></tr>
        </table>
      </span></td>
      <td><button onclick="minus(minislN); return false;">-</button></td>
      <td class="below"><input type="number" id="minislN" name="minislN" min="-1" max="500" value="-2"><br>pieces</td>
      <td><button onclick="plus(minislN); return false;">+</button></td>
      <td><button onclick="minus(minislG); return false;">-</button></td>
      <td class="below"><input type="number" id="minislG" name="minislG" min="-1" max="500" value="-2"><br>pieces</td>
      <td><button onclick="plus(minislG); return false;">+</button></td>
      <td><button onclick="minus(minislK); return false;">-</button></td>
      <td class="below"><input type="number" id="minislK" name="minislK" min="-1" max="500" value="-2"><br>pieces</td>
      <td><button onclick="plus(minislK); return false;">+</button></td>
    </tr>
    <tr><td class="col1 pop" onclick="pop('miniStapled')">stapled
      <span class="popuptext" id="popminiStapled">
        <table>
          <tr><th colspan="2">stapled last updated</th></tr>
          <tr><td>Natural</td><td id="updateministapledN" class="update">date</td></tr>
          <tr><td>Gray</td>   <td id="updateministapledG" class="update">date</td></tr>
          <tr><td>Kona</td>   <td id="updateministapledK" class="update">date</td></tr>
        </table>
      </span></td>
      <td><button onclick="minus(ministapledN); return false;">-</button></td>
      <td class="below"><input type="number" id="ministapledN" name="ministapledN" min="-1" max="500" value="-2"><br>frames</td>
      <td><button onclick="plus(ministapledN); return false;">+</button></td>
      <td><button onclick="minus(ministapledG); return false;">-</button></td>
      <td class="below"><input type="number" id="ministapledG" name="ministapledG" min="-1" max="500" value="-2"><br>frames</td>
      <td><button onclick="plus(ministapledG); return false;">+</button></td>
      <td><button onclick="minus(ministapledK); return false;">-</button></td>
      <td class="below"><input type="number" id="ministapledK" name="ministapledK" min="-1" max="500" value="-2"><br>frames</td>
      <td><button onclick="plus(ministapledK); return false;">+</button></td>
    </tr>
    <tr><td class="col1 pop" onclick="pop('miniD')">completed
      <span class="popuptext" id="popminiD">
        <table>
          <tr><th colspan="2">completed last updated</th></tr>
          <tr><td>Natural</td><td id="updateminidN" class="update">date</td></tr>
          <tr><td>Gray</td>   <td id="updateminidG" class="update">date</td></tr>
          <tr><td>Kona</td>   <td id="updateminidK" class="update">date</td></tr>
        </table>
      </span></td>
      <td><button onclick="minus(minidN); return false;">-</button></td>
      <td class="below"><input type="number" id="minidN" name="minidN" min="-1" max="500" value="-2"><br>frames</td>
      <td><button onclick="plus(minidN); return false;">+</button></td>
      <td><button onclick="minus(minidG); return false;">-</button></td>
      <td class="below"><input type="number" id="minidG" name="minidG" min="-1" max="500" value="-2"><br>frames</td>
      <td><button onclick="plus(minidG); return false;">+</button></td>
      <td><button onclick="minus(minidK); return false;">-</button></td>
      <td class="below"><input type="number" id="minidK" name="minidK" min="-1" max="500" value="-2"><br>frames</td>
      <td><button onclick="plus(minidK); return false;">+</button></td>
    </tr>
  </table>
  <input type="submit" value="Update quantities">
</form>

<div id="successful"> The quantities were updated successfully.</div>
<footer id="date">
</footer>

<script>

  // add one point to a child
  function plus(number) { 
    number.value = parseInt(number.value) + 1;
    return false;
  };

  // subtract one point from a child
  function minus(number) { 
    number.value = parseInt(number.value) - 1;
  };

  // displays popup messages
  function pop(id) {
    document.getElementById("pop" + id).classList.toggle("show");
  };
  function show() { 
    document.getElementById("add").style.display = "initial";
  }

  function load() {

    //get the data from the database
    var xmlHttpRequest = new XMLHttpRequest();

    // browser info
    var phone = [screen.width, screen.height, screen.availWidth, screen.availHeight, screen.colorDepth, screen.pixelDepth];
    var browser = [navigator.appCodeName, navigator.appName, navigator.appVersion, navigator.cookieEnabled, navigator.language, navigator.onLine, navigator.platform, navigator.userAgent];
    browser = navigator.appVersion.substring(navigator.appVersion.lastIndexOf(";") + 2, navigator.appVersion.indexOf(")"));

    console.log("phone " + phone);
    console.log("browser " + browser);

    xmlHttpRequest.onreadystatechange = function() {
      if (xmlHttpRequest.readyState == XMLHttpRequest.DONE && xmlHttpRequest.status == 200 ) {

        console.log('inside if statement');
        var data = JSON.parse(xmlHttpRequest.responseText);
        var total;

        for (var i = 0; i < data.wood.length; i++) { 
          document.getElementsByTagName('input')[i].value = data.wood[i].quantity;
          document.getElementsByClassName('update')[i].innerHTML = formatDate(data.wood[i].dateupdated);
        }

        // check if new quantities were submitted
        if (data.submit[0].success == true) {
          var success = document.getElementById("successful");
          success.className = "show";
          setTimeout(function(){ success.className = success.className.replace("show", ""); }, 3000);
        }

      }
    }
    //the json is from the database here
    xmlHttpRequest.open('GET', 'https://nates-apps.herokuapp.com/getInventory?phone=' + phone + navigator.appVersion.substring(navigator.appVersion.lastIndexOf(";") + 2, navigator.appVersion.indexOf(")")), true);
    xmlHttpRequest.send();

  };

  // returns the date data type in this form September 24, 2020
  function formatDate(date) {
    var month = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
    return (date.substring(5,6) > 0) ? month[date.substring(5 ,7) - 1] : month[date.substring(6 ,7) - 1] + " " + date.substring(8, 10) + ", " + date.substring(0, 4);

  };

</script>
</body>
</html>